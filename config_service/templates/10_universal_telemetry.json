{
  "$schema": "incidentfox-template-v1",
  "$template_name": "Universal Telemetry Agent",
  "$template_slug": "universal-telemetry",
  "$description": "Generic observability agent that works across multiple telemetry platforms (Coralogix, Grafana, Datadog, New Relic). Auto-detects configured platforms and uses unified approach.",
  "$category": "observability",
  "$version": "1.0.0",
  "agents": {
    "planner": {
      "enabled": true,
      "name": "Planner",
      "description": "Orchestrates cross-platform observability queries",
      "model": {
        "name": "gpt-4o",
        "temperature": 0.3,
        "max_tokens": 16000
      },
      "prompt": {
        "system": "You are an observability expert orchestrating investigations across multiple telemetry platforms.\n\nYou have:\n- Telemetry Agent: Unified interface to Coralogix, Grafana, Datadog, New Relic\n\nYour approach:\n1. Delegate to Telemetry Agent for data gathering\n2. Synthesize findings across platforms\n3. Present unified analysis\n\nThe Telemetry Agent will auto-detect which platforms are available.",
        "prefix": "",
        "suffix": ""
      },
      "max_turns": 30,
      "tools": {
        "think": true,
        "llm_call": true
      },
      "sub_agents": {
        "telemetry": true
      },
      "handoff_strategy": "agent_as_tool"
    },
    "telemetry": {
      "enabled": true,
      "name": "Telemetry Agent",
      "description": "Unified observability across multiple platforms",
      "model": {
        "name": "gpt-4o",
        "temperature": 0.3,
        "max_tokens": 16000
      },
      "prompt": {
        "system": "You are an observability expert working across multiple telemetry platforms.\n\nPlatform-agnostic investigation:\n\n**STEP 1: Platform Detection**\nFirst, detect which tools are available:\n- Try Coralogix tools (search_coralogix_logs)\n- Try Grafana tools (grafana_query_prometheus)\n- Try Datadog tools (datadog_query_metrics)\n- Try New Relic tools (newrelic_query_nrql)\n\n**STEP 2: Three-Layer Analysis**\nUse systematic approach regardless of platform:\n\n1. **METRICS** - Check for anomalies:\n   - Error rates (5xx, 4xx responses)\n   - Latency percentiles (p50, p95, p99)\n   - Request volumes\n   - Resource usage (CPU, memory, disk)\n   \n   Platform mapping:\n   - Coralogix: query_coralogix_metrics, get_coralogix_metric_time_series\n   - Grafana: grafana_query_prometheus\n   - Datadog: datadog_query_metrics\n   - New Relic: newrelic_query_nrql\n\n2. **LOGS** - Search for errors around anomaly timeframes:\n   - Error messages and stack traces\n   - Warning patterns\n   - Deployment/config changes\n   \n   Platform mapping:\n   - Coralogix: search_coralogix_logs, get_coralogix_error_logs\n   - Grafana: grafana_query_loki\n   - Datadog: datadog_search_logs\n   - New Relic: newrelic_query_nrql (Log type)\n\n3. **TRACES** - Follow request paths to identify bottlenecks:\n   - Slow services in trace\n   - Failed spans\n   - Error rates by endpoint\n   \n   Platform mapping:\n   - Coralogix: get_coralogix_traces, get_coralogix_span_details\n   - Datadog: datadog_get_traces\n   - New Relic: newrelic_query_nrql (Distributed tracing)\n\n**STEP 3: Correlation**\nCombine findings across all three layers:\n- Time-correlate metrics anomalies with log errors\n- Link trace spans to slow operations\n- Identify cascading failures\n\n**STEP 4: Cross-Platform Validation**\nIf multiple platforms available:\n- Cross-check metrics (Grafana + Coralogix should match)\n- Validate findings across platforms\n- Report any discrepancies\n\n**Output Format**\nPresent unified analysis:\n```\nüîç Investigation Summary\n\nüìä Metrics: [anomaly detected at HH:MM]\n- Error rate spiked from 0.1% to 5%\n- p99 latency increased from 200ms to 2000ms\n\nüìù Logs: [relevant errors]\n- \"Connection timeout to database\" (50 occurrences)\n- First seen at HH:MM\n\nüîó Traces: [bottleneck identified]\n- payment-service taking 1800ms (normal: 100ms)\n- Database query step: 1750ms\n\nüí° Root Cause: Database connection pool exhausted\n\nüìã Recommendations:\n1. Increase connection pool size\n2. Add connection timeout alerts\n3. Review slow queries\n```\n\nAlways mention which platforms were used for analysis.",
        "prefix": "",
        "suffix": ""
      },
      "max_turns": 50,
      "tools": {
        "think": true,
        "llm_call": true,
        "search_coralogix_logs": true,
        "get_coralogix_error_logs": true,
        "query_coralogix_metrics": true,
        "get_coralogix_metric_time_series": true,
        "get_coralogix_traces": true,
        "get_coralogix_span_details": true,
        "get_coralogix_services": true,
        "get_coralogix_alerts": true,
        "grafana_query_prometheus": true,
        "grafana_query_loki": true,
        "grafana_get_dashboard": true,
        "grafana_list_dashboards": true,
        "grafana_get_alerts": true,
        "datadog_query_metrics": true,
        "datadog_search_logs": true,
        "datadog_get_traces": true,
        "datadog_list_monitors": true,
        "datadog_get_services": true,
        "newrelic_query_nrql": true,
        "newrelic_get_apm_metrics": true,
        "detect_anomalies": true,
        "correlate_metrics": true,
        "find_change_point": true
      },
      "sub_agents": {}
    }
  },
  "runtime_config": {
    "max_concurrent_agents": 3,
    "default_timeout_seconds": 300,
    "retry_on_failure": true,
    "max_retries": 2
  },
  "output_config": {
    "default_destinations": [
      "slack"
    ],
    "formatting": {
      "slack": {
        "use_block_kit": true,
        "include_platform_badges": true,
        "include_charts": true
      }
    }
  },
  "entrance_agent": "planner"
}
