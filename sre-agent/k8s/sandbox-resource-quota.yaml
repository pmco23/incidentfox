# ResourceQuota to limit sandbox resource consumption
# Prevents runaway resource exhaustion from accumulated sandboxes
#
# Limits:
# - Max 50 investigation pods (each sandbox creates 1 pod)
# - Max 100Gi memory total for all sandbox pods
# - Max 50 CPU cores total for all sandbox pods
---
apiVersion: v1
kind: ResourceQuota
metadata:
  name: sandbox-quota
  namespace: incidentfox-prod
spec:
  hard:
    # Pod count limit - main protection against accumulation
    count/pods: "100"

    # Memory limits (sandboxes request 512Mi, limit 2Gi each)
    requests.memory: "50Gi"
    limits.memory: "150Gi"

    # CPU limits (sandboxes request 100m, limit 2000m each)
    requests.cpu: "10"
    limits.cpu: "100"

    # Ephemeral storage (sandboxes request 2Gi, limit 10Gi each)
    requests.ephemeral-storage: "100Gi"
    limits.ephemeral-storage: "500Gi"
